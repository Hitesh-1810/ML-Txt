
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

df=pd.read_csv("C:/Desktop Dummy/ml practicals/wine.csv")

df

df.info()

df.describe()

df.columns

df.head()

df.tail()

df.shape

df.dtypes

df.isnull().sum()

df.dtypes

print(df.columns.tolist())

# Visualize Target Distribution
# ------------------------------------------
sns.countplot(x='Wine', data=df)
plt.title("Wine Class Distribution")
plt.show()

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test = train_test_split(df,target,test_size =0.20,random_state=12)

X_train.head()


from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)



X_train

X_train = pd.DataFrame(X_train)
X_test = pd.DataFrame(X_test)

X_train.iloc[81]


from sklearn.linear_model import LogisticRegression
model  = LogisticRegression()
model.fit(X_train,y_train)


from sklearn.metrics import classification_report
y_predict= model.predict(X_test)
y_actual=y_test
y_predict
y_actual
print(classification_report(y_actual,y_predict))


plt.figure(figsize=(10, 8))
sns.heatmap(X_train.corr(), annot=True, cmap='coolwarm')
plt.title("Correlation Heatmap of Standardized Features")
plt.show()



from sklearn.decomposition import PCA
pca = PCA(n_components=2)

tr_comp = pca.fit_transform(X_train)
ts_comp = pca.fit_transform(X_test)

#tr_comp = pd.DataFrame(tr_comp)
#ts_comp = pd.DataFrame(ts_comp)


tr_comp

from sklearn.linear_model import LogisticRegression
pc_model = LogisticRegression()
pc_model.fit(tr_comp,y_train)
y_predict=pc_model.predict(ts_comp)
y_predict
y_actual=y_test
print(classification_report(y_actual,y_predict))


# Get the principal components directly from pca.components_
principal_components = pca.components_

print("Principal Components:")
print(principal_components)



# Create a scatter plot to visualize the principal components
plt.figure(figsize=(8, 6))
plt.scatter(tr_comp[:, 0], tr_comp[:, 1], c=y_train, cmap='viridis', edgecolor='k')
plt.xlabel('Principal Component 1')
plt.ylabel('Principal Component 2')
plt.title('PCA: Principal Components')
plt.colorbar()
plt.show()


pca_df = pd.DataFrame(tr_comp, columns=['PC1', 'PC2'])
pca_df['Wine'] = y_train.values

plt.figure(figsize=(8,8))
sns.pairplot(pca_df, hue='Wine', height=2.5)
plt.suptitle("Pairplot of PCA Components", y=1.02)
plt.show()


